import{r as E,m as N,y as k,i as w,h,z as j,A as H,F as C,B as R,u as A,x as D,o as y,t as F}from"./index-XlqSScU4.js";import{$ as t,D as q}from"./dataTables.responsive-CPZ25JVB.js";import"./dataTables.rowGroup-D6xvC1Rp.js";const U={processing:"處理中...",loadingRecords:"載入中...",paginate:{first:"第一頁",previous:"上一頁",next:"下一頁",last:"最後一頁"},emptyTable:"目前沒有資料",datetime:{previous:"上一頁",next:"下一頁",hours:"時",minutes:"分",seconds:"秒",amPm:["上午","下午"],unknown:"未知",weekdays:["週日","週一","週二","週三","週四","週五","週六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},searchBuilder:{add:"新增條件",condition:"條件",button:{_:"複合查詢 (%d)",0:"複合查詢"},clearAll:"清空",conditions:{array:{contains:"含有",equals:"等於",empty:"空值",not:"不等於",notEmpty:"非空值",without:"不含"},date:{after:"大於",before:"小於",between:"在其中",empty:"為空",equals:"等於",not:"不為",notBetween:"不在其中",notEmpty:"不為空"},number:{between:"在其中",empty:"為空",equals:"等於",gt:"大於",gte:"大於等於",lt:"小於",lte:"小於等於",not:"不為",notBetween:"不在其中",notEmpty:"不為空"},string:{contains:"含有",empty:"為空",endsWith:"字尾為",equals:"等於",not:"不為",notEmpty:"不為空",startsWith:"字首為",notContains:"不含",notStartsWith:"開頭不是",notEndsWith:"結尾不是"}},data:"欄位",leftTitle:"群組條件",logicAnd:"且",logicOr:"或",rightTitle:"取消群組",title:{_:"複合查詢 (%d)",0:"複合查詢"},value:"內容",deleteTitle:"刪除篩選條件"},editor:{close:"關閉",create:{button:"新增",title:"新增資料",submit:"送出新增"},remove:{button:"刪除",title:"刪除資料",submit:"送出刪除",confirm:{_:"您確定要刪除您所選取的 %d 筆資料嗎？",1:"您確定要刪除您所選取的 1 筆資料嗎？"}},error:{system:"系統發生錯誤(更多資訊)"},edit:{button:"修改",title:"修改資料",submit:"送出修改"},multi:{title:"多重值",info:"您所選擇的多筆資料中，此欄位包含了不同的值。若您想要將它們都改為同一個值，可以在此輸入，要不然它們會保留各自原本的值。",restore:"復原",noMulti:"此輸入欄需單獨輸入，不容許多筆資料一起修改"}},autoFill:{cancel:"取消"},buttons:{copySuccess:{_:"複製了 %d 筆資料",1:"複製了 1 筆資料"},copyTitle:"已經複製到剪貼簿",excel:"Excel",pdf:"PDF",print:"列印",copy:"複製",colvis:"欄位顯示",colvisRestore:"重置欄位顯示",csv:"CSV",pageLength:{"-1":"顯示全部",_:"顯示 %d 筆"},createState:"建立狀態",removeAllStates:"移除所有狀態",removeState:"移除",renameState:"重新命名",savedStates:"儲存狀態",stateRestore:"狀態 %d",updateState:"更新",collection:"更多"},searchPanes:{collapse:{_:"搜尋面版 (%d)",0:"搜尋面版"},emptyPanes:"沒搜尋面版",loadMessage:"載入搜尋面版中...",clearMessage:"清空",count:"{total}",countFiltered:"{shown} ({total})",showMessage:"顯示全部",collapseMessage:"摺疊全部",title:"篩選條件 - %d"},stateRestore:{emptyError:"名稱不能空白。",creationModal:{button:"建立",columns:{search:"欄位搜尋",visible:"欄位顯示"},name:"名稱：",order:"排序",paging:"分頁",scroller:"卷軸位置",search:"搜尋",searchBuilder:"複合查詢",select:"選擇",title:"建立新狀態",toggleLabel:"包含："},duplicateError:"此狀態名稱已經存在。",emptyStates:"名稱不可空白。",removeConfirm:"確定要移除 %s 嗎？",removeError:"移除狀態失敗。",removeJoiner:"和",removeSubmit:"移除",removeTitle:"移除狀態",renameButton:"重新命名",renameLabel:"%s 的新名稱：",renameTitle:"重新命名狀態"},select:{columns:{_:"選擇了 %d 欄資料",1:"選擇了 1 欄資料"},rows:{1:"選擇了 1 筆資料",_:"選擇了 %d 筆資料"},cells:{1:"選擇了 1 格資料",_:"選擇了 %d 格資料"}},zeroRecords:"沒有符合的資料",aria:{sortAscending:"：升冪排列",sortDescending:"：降冪排列"},info:"顯示第 _START_ 至 _END_ 筆結果，共 _TOTAL_ 筆",infoEmpty:"顯示第 0 至 0 筆結果，共 0 筆",infoThousands:",",lengthMenu:"顯示 _MENU_ 筆結果",search:"搜尋：",searchPlaceholder:"請輸入關鍵字",thousands:",",infoFiltered:"(從 _MAX_ 筆結果中篩選)"},z={columns:[{data:"productId",width:"5%",className:"text-center"},{data:"productName",width:"34%"},{data:"specification",width:"29%"},{data:"componentClassificationName",visible:!1},{data:"price",width:"8%",className:"text-center"},{data:"wattage",width:"8%",className:"text-center",render:function(a,o,r){return o==="sort"?a:`<input type="text" class="${r.productId}_watt defaultCellType" value="${a}" style="width: 50px; text-align: center;"  disabled>`},type:"num"},{data:"recommend",width:"8%",className:"text-center",render:function(a,o,r){if(o==="sort")return a;let n=r.productId;const m=a==0?"selected":"",d=a==1?"selected":"",u=a==2?"selected":"",T=a==3?"selected":"",_=`<option value = "0" ${m}>無</option>`,g=`<option value = "1" ${d}>基本</option>`,v=`<option value = "2" ${u}>優良</option>`,$=`<option value = "3" ${T}>完美</option>`;return`<select class="${n}_recommend defaultCellType" disabled>${_}${g}${v}${$}</select>`},type:"num"},{data:null,orderable:!1,width:"8%",render:function(a,o,r){let n=r.productId,m=`<button class="${n}_edit btn Edit-btn d-flex justify-content-center align-items-center" style="width:30px;height:30px;"><i class="fa-solid fa-pen-to-square"></i></button>`,d=`<div class="d-flex justify-content-between" id="${n}_div">${m}</div>`;return o==="display"?`${d}`:a},type:"html"}],responsive:!0,language:U,order:[[1,"asc"]],rowGroup:{dataSrc:"componentClassificationName"},processing:!0,autoWidth:!0,createdRow:function(a,o){t(a).attr("id",o.productId+"_row"),t(a).find("td:eq(6)").addClass("d-flex"),t(a).find("td:eq(6)").addClass("justify-content-center")}},B="https://localhost:7135",S=E([]);function L(){fetch(`${B}/api/HardwareManage/GetComputerParts`,{method:"GET"}).then(a=>{if(!a.ok)throw new Error("Network response was not ok");return a.json()}).then(a=>{S.value=a}).catch(a=>{console.error("There was a problem with the fetch operation:",a)})}function I(a){let o=`<div class="spinner-border spinner-border-sm animate__animated me-2" role="status" id="${a}_Toast_Status"></div>`,r=`<div class="ToastIcon-success d-flex justify-content-center align-items-center animate__animated me-2 d-none" id="${a}_ToastIcon_success"><i class="fa-solid fa-check"></i></div>`,n=`<div class="ToastIcon-fail d-flex justify-content-center align-items-center animate__animated me-2 d-none" id="${a}_ToastIcon_fail"><i class="fa-solid fa-xmark"></i></div>`,m=`<span style="margin-top: 2px" id="${a}_ToastText">請求傳送中</span>`,d=`<svg width="250px" height="2px" class="position-absolute bottom-0 start-0" style="display: none" id="${a}_ToastProgress"><rect width="250px" height="2px" style="fill: #00FF00" id="${a}_ToastProgress_rect"></rect></svg>`;return`<div class="toast align-items-center mb-3 animate__animated animate__fadeInLeft defaultToast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false" id="${a}_Toast"><div class="d-flex align-items-center"><div class="toast-body d-flex align-items-center position-relative">${o}${r}${n}${m}${d}</div></div></div>`}function b(a){let o=250,r=250/200;var n=setInterval(function(){o-=r,t(`#${a}_ToastProgress_rect`).attr("width",`${o}px`),o<=0&&(clearInterval(n),t(`#${a}_Toast`).addClass("animate__fadeOutRight"),setTimeout(function(){t(`#${a}_Toast`).remove()},1e3))},10)}const O={class:"row"},V=h("div",{class:"col-12 col-md-6 order-md-1 d-flex justify-content-center justify-content-md-start"},[h("h2",{style:{"margin-top":"8px"}},"產品管理系統")],-1),W={class:"col-12 col-md-6 order-md-2 d-flex justify-content-center justify-content-md-end align-items-center"},G=h("option",{value:"0",disabled:"",selected:"",hidden:""},"---- 請選擇硬體 ----",-1),J=["value"],X=D('<section class="section"><table id="HardwareManageTable" class="display" style="width:100%;"><thead id="HardwareThead"><tr><th data-priority="1">ID</th><th>產品名稱</th><th>規格</th><th>種類</th><th>價格</th><th>瓦數</th><th>推薦</th><th data-priority="2"></th></tr></thead></table></section><div class="position-fixed top-0 start-50 translate-middle-x p-3" style="z-index:9999;" id="ToastContainer"></div>',2),Z={__name:"ProductManage",emits:["UpdateOneHardware","UpdateAllHardware"],setup(a,{emit:o}){const r="https://localhost:7135",n=E("0"),m=o;let d=null,u=!1;const T={...z,layout:{topMiddle:{buttons:[{text:"重新整理",action:function(){u=!0,_()}},{text:"單一零件更新",action:function(){v()}},{text:"全零件更新",action:function(){$()}}]}}};function _(){if(n.value=="0")return;let s=null,e=0,l=null;u&&(s=document.querySelector("#ToastContainer"),e=Math.floor(Math.random()*1e3),l=I(e));const f=n.value;fetch(`${r}/api/HardwareManage/GetProductData?Type=${f}`,{method:"GET"}).then(c=>{if(u&&(s.insertAdjacentHTML("afterbegin",l),t(`#${e}_Toast`).show(),t(`#${e}_Toast_Status`).hide()),c.ok)return c.json()}).then(c=>{d.clear().draw(),d.rows.add(c).draw(),u&&(t(`#${e}_ToastIcon_success`).addClass("animate__zoomIn").removeClass("d-none"),t(`#${e}_ToastText`).text("重新整理成功"),t(`#${e}_ToastProgress`).show(),b(e)),u=!1}).catch(c=>{alert(c),u&&(t(`#${e}_ToastIcon_fail`).addClass("animate__zoomIn").removeClass("d-none"),t(`#${e}_ToastText`).text("重新整理失敗，請稍後再試"),t(`#${e}_ToastProgress_rect`).css("fill","#FF0000"),t(`#${e}_ToastProgress`).show(),b(e)),u=!1})}function g(){_()}function v(){const s=n.value,e="One";s!="0"&&m("UpdateOneHardware",s,e)}function $(){m("UpdateAllHardware","All")}return N(()=>{L(),d=new q("#HardwareManageTable",T),t(document).on("click",".Edit-btn",function(){if(t(this).css("display")!=="none"){let s=Number(t(this).attr("class").slice(0,5)),e=Number(t(`.${s}_watt:visible`).val()),l=Number(t(`.${s}_recommend:visible`).val()),f=`<button class="${s}_enter btn Enter-btn d-flex justify-content-center align-items-center" style="width:30px;height:30px;"><i class="fa-solid fa-check"></i></button>`,c=`<button class="${s}_reset btn Cancel-btn d-flex justify-content-center align-items-center" style="width:30px;height:30px;" data-origin="${e},${l}"><i class="fa-solid fa-xmark"></i></button>`;t(`#${s}_div`).html(`${f}&nbsp;&nbsp;&nbsp;${c}`),t(`.${s}_watt`).prop("disabled",!1),t(`.${s}_watt`).removeClass("defaultCellType"),t(`.${s}_recommend`).prop("disabled",!1),t(`.${s}_recommend`).removeClass("defaultCellType")}}),t(document).on("click",".Enter-btn",function(){if(t(this).css("display")!=="none"){let e=Number(t(this).attr("class").slice(0,5)),l=Number(t(`.${e}_watt:visible`).val()),f=Number(t(`.${e}_recommend:visible`).val()),c=document.querySelector("#ToastContainer");var s={ProductId:e,Wattage:l,Recommend:f};let i=Math.floor(Math.random()*1e3),M=I(i);c.insertAdjacentHTML("afterbegin",M);let x=!1;t(`#${i}_Toast`).show(),fetch(`${r}/api/HardwareManage/ProductDataUpdate`,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then(p=>(t(`#${i}_Toast_Status`).addClass("animate__zoomOut"),t(`#${i}_Toast_Status`).hide(),p.ok&&(x=!0),p.text())).then(p=>{if(x){t(`#${i}_ToastIcon_success`).addClass("animate__zoomIn").removeClass("d-none"),t(`#${i}_ToastText`).text(p),t(`#${i}_ToastProgress`).show(),b(i),t(`.${e}_watt`).attr("disabled",!0),t(`.${e}_watt`).addClass("defaultCellType"),t(`.${e}_recommend`).attr("disabled",!0),t(`.${e}_recommend`).addClass("defaultCellType");let P=`<button class="${e}_edit btn Edit-btn d-flex justify-content-center align-items-center" style="width:30px;height:30px;" data-bs-toggle="popover" data-bs-content="nothing"><i class="fa-solid fa-pen-to-square"></i></button>`;t(`#${e}_div`).html(P)}else t(`#${i}_ToastIcon_fail`).addClass("animate__zoomIn").removeClass("d-none"),t(`#${i}_ToastText`).text(p),t(`#${i}_ToastProgress`).show(),t(`#${i}_ToastProgress_rect`).css("fill","#FF0000"),b(i)}).catch(p=>{t(`#${i}_ToastIcon_fail`).addClass("animate__zoomIn").removeClass("d-none"),t(`#${i}_ToastText`).text(p.message)})}}),t(document).on("click",".Cancel-btn",function(){if(t(this).css("display")!=="none"){let s=Number(t(this).attr("class").slice(0,5)),e=t(this).attr("data-origin").split(","),l=Number(e[0]),f=Number(e[1]);t(`.${s}_watt`).attr("disabled",!0),t(`.${s}_watt`).val(l),t(`.${s}_watt`).addClass("defaultCellType"),t(`.${s}_recommend`).attr("disabled",!0),t(`.${s}_recommend`).val(f),t(`.${s}_recommend`).addClass("defaultCellType");let c=`<button class="${s}_edit btn Edit-btn d-flex justify-content-center align-items-center" style="width:30px;height:30px;" data-bs-toggle="popover" data-bs-content="nothing"><i class="fa-solid fa-pen-to-square"></i></button>`;t(`#${s}_div`).html(c)}})}),k(()=>{d.clear().draw(),d.destroy(),d=null,t(document).off("click",".Enter-btn"),t(document).off("click",".Cancel-btn"),t(document).off("click",".Edit-btn")}),(s,e)=>(y(),w(C,null,[h("div",O,[V,h("div",W,[j(h("select",{class:"form-select mb-0",style:{width:"250px",height:"40px","margin-bottom":"8px"},onChange:e[0]||(e[0]=l=>g()),"onUpdate:modelValue":e[1]||(e[1]=l=>n.value=l)},[G,(y(!0),w(C,null,R(A(S),l=>(y(),w("option",{key:l.id,value:l.id},F(l.name),9,J))),128))],544),[[H,n.value]])])]),X],64))}};export{Z as default};
